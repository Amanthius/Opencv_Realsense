# **OpenCV 与 Realsense 视觉项目库 (opencv\_Realsense)**

本项目是一个基于 **Intel® RealSense™ D435 深度摄像头** 和 **OpenCV** 的综合计算机视觉实验与项目集合。仓库内容从基础的视觉处理任务，到高级的深度学习模型（YOLOv8）的完整训练与部署，最后实现了2D检测与3D深度数据的融合。

## **核心硬件与软件栈**

* **核心硬件**: Intel® RealSense™ D435 深度摄像头  
* **核心软件**: Python 3.10+, Anaconda/Miniconda, Intel RealSense SDK 2.0  
* **主要Python库**:  
  * opencv-contrib-python (OpenCV完整版)  
  * pyrealsense2 (Realsense SDK的Python接口)  
  * ultralytics (YOLOv8 框架)  
  * torch (PyTorch, YOLOv8的后端)  
  * numpy

## **项目结构与内容**

本仓库主要包含以下三个核心项目，分别对应三个子文件夹：

### **1\. opencv实验合集**

这是一个基于OpenCV和Realsense D435的基础视觉实验平台。所有实验被集成到一个统一的Python脚本中，通过交互式菜单调用。

项目目的  
旨在通过一系列实践项目，帮助学习者快速掌握OpenCV的核心功能以及Realsense摄像头的基本使用方法。  
**主要实验内容**

* **物体识别类**:  
  * 人脸检测 (Haar)  
  * 人体检测 (HOG)  
  * 手势识别 (基于深度与凸包分析)  
* **颜色识别类**:  
  * HSV颜色查找工具  
  * 特定颜色物体跟踪  
* **基础检测**:  
  * Canny边缘检测  
  * QR二维码识别  
  * ArUco标记检测与姿态估计 (PnP)  
* **人脸识别套件**:  
  * \[步骤1\] 采集人脸数据  
  * \[步骤2\] 训练人脸模型 (LBPH)  
  * \[步骤3\] 实时人脸识别 (自动用户管理)

### **2\. 实时检测全流程训练**

这是一个完整的端到端（End-to-End）项目，详细演示了如何使用YOLOv8模型训练一个自定义的物体检测器。

项目目的  
引导用户完整经历一个现代计算机视觉项目的全流程：从原始数据采集到最终的智能应用部署，掌握数据驱动和模型迭代的科学方法。  
**核心工作流**

1. **数据收集**: 使用Realsense摄像头采集自定义物体（如饮料瓶、水果等）的图像，并强调数据集的**多样性**（光照、背景、角度）。  
2. **数据标注**: 使用 labelImg 独立发行版，为采集的图像创建YOLO格式的标签文件。  
3. **模型训练**: 利用 ultralytics 库，在 yolov8n.pt 预训练模型的基础上，使用自定义数据集进行**迁移学习**。  
4. **模型部署**: 加载训练生成的最佳模型 (best.pt)，对Realsense的实时视频流进行2D物体检测。

### **3\. 融合深度的实时检测**

本项目是**项目2**的直接进阶，将2D的物体检测提升至3D空间感知。

项目目的  
充分利用Realsense D435的深度传感能力，实现对YOLOv8检测到的物体进行实时三维空间定位，回答“物体离我有多远？”这一核心问题，为机器人抓取、AR等高级应用奠定基础。  
**核心技术原理**

1. **帧对齐 (Frame Alignment)**: 解决彩色摄像头和深度摄像头之间的**视差问题**。通过使用 rs.align 对象，将深度图重投影到彩色图的坐标空间，确保彩色图中的任一像素 (x, y) 都与深度图中的 (x, y) 对应空间中的同一点。  
2. **深度提取**: 在YOLOv8检测到物体的2D边界框后，计算其中心点坐标 (cx, cy)。  
3. **实时测距**: 利用对齐后的深度帧，直接调用 depth\_frame.get\_distance(cx, cy) 来获取该点距离摄像头的**真实物理距离**（单位：米）。  
4. **信息融合**: 将2D检测框、类别信息与3D深度距离同时可视化在实时画面上。

## **如何使用**

1. **环境配置**:  
   * 安装 [Intel RealSense SDK 2.0](https://github.com/IntelRealSense/librealsense/releases)。  
   * 使用Anaconda创建一个新的Python 3.10环境。  
   * 根据“核心软件与软件栈”列表，使用 pip 或 conda 安装所有必需的Python库。  
2. **运行项目**:  
   * **项目1 (opencv实验合集)**:  
     * cd opencv实验合集  
     * python test.py (或主脚本名称)  
     * 根据终端菜单提示输入数字来运行不同的实验。  
   * **项目2 (实时检测全流程训练)**:  
     * cd 实时检测全流程训练  
     * 按照 1\_data\_collection.py, 2\_annotation\_guide.md, 3\_model\_training.py, 4\_realtime\_detection.py 的顺序依次执行。  
     * **注意**: 必须先完成前三步，才能运行第四步的实时检测。  
   * **项目3 (融合深度的实时检测)**:  
     * 确保您已成功完成**项目2**并生成了 best.pt 模型文件。  
     * cd 融合深度的实时检测
